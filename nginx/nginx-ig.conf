# Idea Garden nginx configuration
# Place this file in /etc/nginx/sites-available/ig
# Then symlink: ln -s /etc/nginx/sites-available/ig /etc/nginx/sites-enabled/ig
# Or add this block to your existing nginx config

location /ig {
    alias /path/to/idea-garden/dist;
    index index.html;
    try_files $uri $uri/ /ig/index.html;
}

# Use a secret path for the API endpoint (e.g., /secret-xyz123/data)
# This path should match VITE_API_PATH used during build
location /your-secret-api-path {
    alias /path/to/projects.json;

    # Enable WebDAV methods for writing
    dav_methods PUT;
    create_full_put_path on;
    dav_access user:rw group:rw all:r;

    # Set content type
    default_type application/json;

    # CORS headers
    add_header Access-Control-Allow-Origin * always;
    add_header Access-Control-Allow-Methods "GET, PUT, OPTIONS" always;
    add_header Access-Control-Allow-Headers "Content-Type" always;

    # Handle preflight requests
    if ($request_method = OPTIONS) {
        return 204;
    }

    # Ensure nginx user can read/write
    client_body_temp_path /tmp/nginx_client_body;
}
